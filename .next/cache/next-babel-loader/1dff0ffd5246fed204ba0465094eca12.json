{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport authRoute from '../../components/HOC/authRoute';\nimport AdminLayout from '../../components/layouts/adminLayout';\nimport { getCookies } from '../../lib/utils';\nimport { connect } from 'react-redux';\nimport { DeleteMessage } from '../../store/actions';\nimport getConfig from 'next/config';\n\nvar _getConfig = getConfig(),\n    publicRuntimeConfig = _getConfig.publicRuntimeConfig;\n\nvar AdminMessages = /*#__PURE__*/function (_Component) {\n  _inherits(AdminMessages, _Component);\n\n  var _super = _createSuper(AdminMessages);\n\n  _createClass(AdminMessages, null, [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n        var req, messagesData, reqCook, response;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                req = _ref.req;\n                reqCook = getCookies(req);\n                _context.prev = 2;\n                _context.next = 5;\n                return axios.get(\"\".concat(publicRuntimeConfig.base_url, \"/api/v1/messages\"), {\n                  headers: {\n                    'authorization': \"Bearer \".concat(reqCook)\n                  }\n                });\n\n              case 5:\n                response = _context.sent;\n                messagesData = response.data;\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](2);\n                console.log(_context.t0);\n\n              case 12:\n                return _context.abrupt(\"return\", {\n                  messagesData: messagesData\n                });\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 9]]);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  function AdminMessages(props) {\n    var _this;\n\n    _classCallCheck(this, AdminMessages);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteMsgHandler\", function (_id) {\n      _this.props.dispatch(DeleteMessage(_id)).then(function () {\n        _this.setState({\n          messages: _this.props.msg.messages\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showMessages\", function (messages) {\n      return messages ? messages.map(function (message) {\n        return __jsx(\"div\", {\n          className: \"item\",\n          key: message._id\n        }, __jsx(\"div\", {\n          className: \"delete_btn\",\n          onClick: function onClick() {\n            return _this.deleteMsgHandler(message._id);\n          }\n        }, \"X\"), __jsx(\"div\", {\n          className: \"tag\"\n        }, __jsx(\"span\", null, \"Name:\"), message.name), __jsx(\"div\", {\n          className: \"tag\"\n        }, __jsx(\"span\", null, \"Email:\"), message.email), __jsx(\"div\", {\n          className: \"msg_wrap\"\n        }, __jsx(\"div\", {\n          className: \"tag\"\n        }, __jsx(\"span\", null, \"Message:\")), __jsx(\"div\", null, message.message)));\n      }) : null;\n    });\n\n    _this.state = {\n      messages: _this.props.messagesData\n    };\n    return _this;\n  }\n\n  _createClass(AdminMessages, [{\n    key: \"render\",\n    value: function render() {\n      return __jsx(AdminLayout, {\n        sectionName: \"Message\"\n      }, __jsx(\"div\", {\n        className: \"messages_container\"\n      }, this.showMessages(this.state.messages)));\n    }\n  }]);\n\n  return AdminMessages;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    msg: state.msg\n  };\n};\n\nexport default connect(mapStateToProps)(authRoute(AdminMessages));","map":{"version":3,"sources":["/Users/disharjayantha/Desktop/projects,practise/Nextjs-PizzaApp/pages/admin/messages.js"],"names":["React","Component","axios","authRoute","AdminLayout","getCookies","connect","DeleteMessage","getConfig","publicRuntimeConfig","AdminMessages","req","reqCook","get","base_url","headers","response","messagesData","data","console","log","props","_id","dispatch","then","setState","messages","msg","map","message","deleteMsgHandler","name","email","state","showMessages","mapStateToProps"],"mappings":";;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,gCAAtB;AACA,OAAOC,WAAP,MAAwB,sCAAxB;AAEA,SAASC,UAAT,QAA2B,iBAA3B;AAEA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,aAAT,QAA8B,qBAA9B;AAEA,OAAOC,SAAP,MAAsB,aAAtB;;iBACgCA,SAAS,E;IAAjCC,mB,cAAAA,mB;;IAGFC,a;;;;;;;;;;;;;;AAC4BC,gBAAAA,G,QAAAA,G;AAEtBC,gBAAAA,O,GAAUP,UAAU,CAACM,GAAD,C;;;uBAGIT,KAAK,CAACW,GAAN,WAAaJ,mBAAmB,CAACK,QAAjC,uBAA4D;AAC/EC,kBAAAA,OAAO,EAAC;AACJ,sDAA0BH,OAA1B;AADI;AADuE,iBAA5D,C;;;AAAjBI,gBAAAA,Q;AAKNC,gBAAAA,YAAY,GAAGD,QAAQ,CAACE,IAAxB;;;;;;;AAEDC,gBAAAA,OAAO,CAACC,GAAR;;;iDAGG;AACHH,kBAAAA,YAAY,EAAZA;AADG,iB;;;;;;;;;;;;;;;;;;AAMX,yBAAYI,KAAZ,EAAkB;AAAA;;AAAA;;AACd,8BAAMA,KAAN;;AADc,uEAQC,UAACC,GAAD,EAAS;AACxB,YAAKD,KAAL,CAAWE,QAAX,CAAoBhB,aAAa,CAACe,GAAD,CAAjC,EAAwCE,IAAxC,CAA6C,YAAI;AAC7C,cAAKC,QAAL,CAAc;AACVC,UAAAA,QAAQ,EAAE,MAAKL,KAAL,CAAWM,GAAX,CAAeD;AADf,SAAd;AAGH,OAJD;AAKH,KAdiB;;AAAA,mEAgBH,UAACA,QAAD;AAAA,aACXA,QAAQ,GACJA,QAAQ,CAACE,GAAT,CAAa,UAACC,OAAD;AAAA,eACT;AAAK,UAAA,SAAS,EAAC,MAAf;AAAsB,UAAA,GAAG,EAAEA,OAAO,CAACP;AAAnC,WACI;AAAK,UAAA,SAAS,EAAC,YAAf;AAA4B,UAAA,OAAO,EAAG;AAAA,mBAAM,MAAKQ,gBAAL,CAAsBD,OAAO,CAACP,GAA9B,CAAN;AAAA;AAAtC,eADJ,EAII;AAAK,UAAA,SAAS,EAAC;AAAf,WAAqB,4BAArB,EAAwCO,OAAO,CAACE,IAAhD,CAJJ,EAKI;AAAK,UAAA,SAAS,EAAC;AAAf,WAAqB,6BAArB,EAAyCF,OAAO,CAACG,KAAjD,CALJ,EAMI;AAAK,UAAA,SAAS,EAAC;AAAf,WACI;AAAK,UAAA,SAAS,EAAC;AAAf,WAAqB,+BAArB,CADJ,EAEI,mBACKH,OAAO,CAACA,OADb,CAFJ,CANJ,CADS;AAAA,OAAb,CADI,GAgBP,IAjBU;AAAA,KAhBG;;AAGd,UAAKI,KAAL,GAAa;AACTP,MAAAA,QAAQ,EAAE,MAAKL,KAAL,CAAWJ;AADZ,KAAb;AAHc;AAMjB;;;;6BA+BO;AACJ,aACI,MAAC,WAAD;AACI,QAAA,WAAW,EAAC;AADhB,SAGI;AAAK,QAAA,SAAS,EAAC;AAAf,SACM,KAAKiB,YAAL,CAAkB,KAAKD,KAAL,CAAWP,QAA7B,CADN,CAHJ,CADJ;AASH;;;;EArEuBzB,S;;AAwE5B,IAAMkC,eAAe,GAAG,SAAlBA,eAAkB,CAACF,KAAD,EAAU;AAC9B,SAAO;AACHN,IAAAA,GAAG,EAAEM,KAAK,CAACN;AADR,GAAP;AAGH,CAJD;;AAMA,eAAerB,OAAO,CAAC6B,eAAD,CAAP,CAAyBhC,SAAS,CAACO,aAAD,CAAlC,CAAf","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport authRoute from '../../components/HOC/authRoute';\nimport AdminLayout from '../../components/layouts/adminLayout';\n\nimport { getCookies } from '../../lib/utils';\n\nimport { connect } from 'react-redux';\nimport { DeleteMessage } from '../../store/actions';\n\nimport getConfig from 'next/config';\nconst { publicRuntimeConfig } = getConfig();\n\n\nclass AdminMessages extends Component {\n    static async getInitialProps({req}){\n        let messagesData;\n        let reqCook = getCookies(req);\n\n        try {\n             const response = await axios.get(`${publicRuntimeConfig.base_url}/api/v1/messages`,{\n                 headers:{\n                     'authorization':`Bearer ${reqCook}`\n                 }\n             });\n             messagesData = response.data;\n        } catch (error){\n            console.log(error)\n        }\n\n        return {\n            messagesData\n        }\n    }\n\n\n    constructor(props){\n        super(props);\n\n        this.state = {\n            messages: this.props.messagesData\n        }\n    }\n\n    deleteMsgHandler = (_id) => {\n        this.props.dispatch(DeleteMessage(_id)).then(()=>{\n            this.setState({\n                messages: this.props.msg.messages\n            })\n        })\n    }\n\n    showMessages = (messages) => (\n        messages ?\n            messages.map((message)=>(\n                <div className=\"item\" key={message._id}>\n                    <div className=\"delete_btn\" onClick={ () => this.deleteMsgHandler(message._id)}>\n                        X\n                    </div>\n                    <div className=\"tag\"><span>Name:</span>{message.name}</div>\n                    <div className=\"tag\"><span>Email:</span>{message.email}</div>\n                    <div className=\"msg_wrap\">\n                        <div className=\"tag\"><span>Message:</span></div>\n                        <div>\n                            {message.message}\n                        </div>\n                    </div>\n                </div>\n            ))\n        :null\n    )\n\n\n    render(){\n        return(\n            <AdminLayout\n                sectionName=\"Message\"\n            >\n                <div className=\"messages_container\">\n                    { this.showMessages(this.state.messages)}\n                </div>\n            </AdminLayout>\n        )\n    }\n}\n\nconst mapStateToProps = (state) =>{\n    return {\n        msg: state.msg\n    }\n}\n\nexport default connect(mapStateToProps)(authRoute(AdminMessages));"]},"metadata":{},"sourceType":"module"}